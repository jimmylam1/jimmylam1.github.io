1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/01fe795c1c688926.css",{"as":"style"}]
0:["qgLdc9Ri7R-98fyV1L63q",[[["",{"children":["projects",{"children":["discordbots",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/01fe795c1c688926.css","precedence":"next"}]],"$L4"]]]]
5:HL["/_next/static/media/916d3686010a8de2-s.p.woff2",{"as":"font","type":"font/woff2"}]
6:HL["/_next/static/media/c04551857776278f-s.p.woff2",{"as":"font","type":"font/woff2"}]
7:HL["/_next/static/media/d36a2a2bb416f59e-s.p.woff2",{"as":"font","type":"font/woff2"}]
8:HL["/_next/static/css/eef3252e494c38ff.css",{"as":"style"}]
9:I{"id":6685,"chunks":["451:static/chunks/451-2f6eec1fc47ee5d0.js","931:static/chunks/app/page-dc35a36568d187d4.js"],"name":"","async":false}
a:I{"id":3222,"chunks":["451:static/chunks/451-2f6eec1fc47ee5d0.js","931:static/chunks/app/page-dc35a36568d187d4.js"],"name":"Image","async":false}
b:I{"id":7767,"chunks":["272:static/chunks/webpack-e54f5f6175cab3f2.js","971:static/chunks/fd9d1056-2a48348db6e9e5e0.js","596:static/chunks/596-38dca328e8a8de9d.js"],"name":"default","async":false}
c:I{"id":7920,"chunks":["272:static/chunks/webpack-e54f5f6175cab3f2.js","971:static/chunks/fd9d1056-2a48348db6e9e5e0.js","596:static/chunks/596-38dca328e8a8de9d.js"],"name":"default","async":false}
d:I{"id":1126,"chunks":["451:static/chunks/451-2f6eec1fc47ee5d0.js","591:static/chunks/app/projects/discordbots/page-6f39dbb2304774bd.js"],"name":"ProjectPage","async":false}
3:[["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__className_20951f","children":[["$","div",null,{"className":"Navbar_nav__uORRK","children":[["$","ul",null,{"children":[["$","li",null,{"children":[["$","$L9",null,{"className":"Navbar_link__ambd4","href":"/","children":"Home"}]," "]}],["$","li",null,{"children":[["$","$L9",null,{"className":"Navbar_link__ambd4","href":"/projects","children":"Projects"}]," "]}]]}],["$","div",null,{"className":"Navbar_linksContainer__uewBo","children":["$","a",null,{"href":"https://github.com/jimmylam1","target":"_blank","children":["$","$La",null,{"className":"Navbar_icon__TvWha","src":"/images/github.png","width":40,"height":40,"alt":"GitHub"}]}]}]]}],["$","div",null,{"children":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","projects","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","projects","children","discordbots","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","div",null,{"className":"projectPage_main__fC8GM","children":["$","div",null,{"className":"projectPage_container__sWJwi","children":[["$","$Ld",null,{"id":0,"title":"Mario Kart Tour Discord Bots","image":"/images/projects/bots.png","category":"Application","tags":["JavaScript","Node.js","MongoDB","Google Sheets API","Web Scraping","Child Processes","OCR"],"bulletPoints":["Centered around the game Mario Kart Tour","Used by thousands of people","Commands are optimized for speed","Extensive use of image generation for the best User Experience"],"pageUrl":"/projects/discordbots","links":{"demo":null,"github":null,"website":"https://mktbots.com","video":null},"isHighlight":true}],["$","div",null,{"className":"projectPage_content__NrO4R","children":[["$","h2",null,{"children":"About"}],["$","p",null,{"children":["For some background, Mario Kart Tour is a mobile game available on Android and iOS devices, and Discord is a messaging platform where conversations take place in communities called \"servers\". Unlike other messaging apps, Discord allows developers to create \"bots\" to enhance the platform. Whenever someone uses a bot command, the bot will reply with something useful.",["$","br",null,{}],["$","br",null,{}],"This page is designed to highlight the major features, decisions I've made, and challenges I've faced when building the bots. To learn more about each bot in detail, visit ",["$","a",null,{"href":"https://mktbots.com","target":"_blank","children":"mktbots.com"}]," to see a list of all their features and commands.",["$","br",null,{}],["$","br",null,{}],"Collectively, my Discord bots are used in over 1,000 Discord servers, and similarly, they are used by an equal, if not more, number of people every day."]}],["$","h2",null,{"children":"How was it built?"}],["$","p",null,{"children":"All my bots are built using JavaScript with Node.js, and the Discord.js library is what I use to connect with Discord. In addition, MongoDB is the database used across all bots. Finally, the bots are all hosted on a DigitalOcean droplet."}],["$","h2",null,{"children":"Common features across all bots"}],["$","p",null,{"children":["All my Discord bots use image generation extensively. Since Discord bots can only display text in a few specific ways, images allow for them to have full control over how responses should look. The way this is accomplished is through the npm package Canvas, and this is a Node.js implementation of the HTML canvas element. For most bot commands, images can be generated on the spot because it takes less than a second to finish. However, there are some issues that arise for Ice Mario and ACR Bot, and they are described below.",["$","br",null,{}],["$","br",null,{}],"Command responsiveness is a top priority. When someone uses a command, they shouldn't need to wait a long time for a response. Whenever necessary, data will be cached like when querying a database or fetching data.",["$","br",null,{}],["$","br",null,{}],"Web scraping is an integral tool for all my bots. They all need images from Mario Kart Tour, and it would be a lot of work to manually add them one by one. In addition, new images are added every two weeks, so it would be a continuous task to do manually. By web scraping ",["$","a",null,{"href":"https://www.mariowiki.com/Mario_Kart_Tour","target":"_blank","children":"Mario Wiki"}],", the bots are able to fetch all the required assets without my assistance.",["$","br",null,{}],["$","br",null,{}],"Connecting to Google Sheets is an essential backend feature, and the Google Sheets API is used throughout to either fetch data or edit a spreadsheet."]}],["$","h2",null,{"children":"Main features and challenges"}],["$","h3",null,{"children":"Ice Mario"}],["$","p",null,{"children":["The table maker is one of Ice Mario's most used command. The original code was made by ",["$","a",null,{"href":"https://github.com/hlorenzi/mk8d_ocr","target":"_blank","children":"Lorenzi"}],", but I have made significant improvements as well as made it compatable with Node.js. Here are some of the features I've added compared to the original:"]}],["$","ul",null,{"children":[["$","li",null,{"children":"Make tables through Discord instead of using a website"}],["$","li",null,{"children":"Ability to add team logos without the need of Photoshop"}],["$","li",null,{"children":"Ability to add custom player flags"}],["$","li",null,{"children":"Ability to add a background image"}],["$","li",null,{"children":"Custom tournament color schemes"}]]}],["$","p",null,{"children":["A challenge with having custom team logos and player flags is figuring out a way to display them. The best way to do so is to generate an image containing them, but it is a CPU heavy task. When there are hundreds of images, fetching and rendering them on a canvas causes the bot to lag significantly. The solution is to fork a child process. When the child process is done, it will save the resulting image to the file system, and the main process will be able to use this image whenever someone needs to view all the logos or flags.",["$","br",null,{}],["$","br",null,{}],"Ice Mario is an integral bot in the MKT Lounge Discord server, where it is responsible for player lounge stats. Originally, the server used a different bot to handle stats, but it was very basic and not customizable. These are some of the features Ice Mario improves over the previous bot:"]}],["$","ul",null,{"children":[["$","li",null,{"children":"Uses generated images for custom layout as well as display stats data using a graph"}],["$","li",null,{"children":"Ability to fetch stats from a previous season"}],["$","li",null,{"children":"List player ranking"}],["$","li",null,{"children":"Predict stats change after an event"}]]}],["$","p",null,{"children":"A challenge with lounge stats is how the data is fetched. For the first 8 seasons of MKT Lounge, player stats were stored in a Google spreadsheet. Since there was a lot of data, fetching a sheet can take a very long time, often over 30 seconds, and this would be terrible to fetch on every command invocation. The solution is to cache all the fetched data, and this allows the bot to have immediate access to them. Starting with season 9, another developer created an API to store stats data, and this data is also cached to preserve speed and maintain reliability in the event the API is unavailable."}],["$","h3",null,{"children":"ACR Bot"}],["$","p",null,{"children":["Unlike Ice Mario, ACR Bot often requires 40 or more driver, kart, or glider images to generate the main response image for the ",["$","code",null,{"children":"/trackinfo"}]," command. While the command can be quick when the images are cached, it can take upwards of 30 seconds or more to generate if the bot were to restart. I quickly realized this approach of generating images was not sufficient for this bot. My solution was to generate all 800+ images, save them, then use them whenever someone uses the command. This significantly improves speed since the bot is now able to respond almost instantaneously.",["$","br",null,{}],["$","br",null,{}],"Another challenge relates to the newest command ",["$","code",null,{"children":"/overlap"}],". Unlike ",["$","code",null,{"children":"/trackinfo"}]," where all the images can be pre-generated, the overlap command cannot do that due to the large number of possible images. My solution was to fork a child process to generate the images, and this prevents the main process from lagging."]}],["$","h3",null,{"children":"MKT Time Trial Bot"}],["$","p",null,{"children":"A major feature of this bot is the ability to use Optical Character Recognition (OCR) to read a screenshot and extract text from it. I initially tried using Tesseract, an OCR engine, but it produced inconsistent results. Instead of attempting to train it, I decided to experiment and create my own OCR reader from analyzing pixel data. The video below is a conceptual overview on how it was done:"}],["$","div",null,{"className":"projectPage_videoWrapper__mmXgF","children":["$","iframe",null,{"className":"projectPage_video__UMhQz","width":"560","height":"315","src":"https://www.youtube.com/embed/Z9gY5Hl13y0","title":"YouTube video player","frameborder":"0","allow":"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share","allowfullscreen":true}]}]]}]]}]}],null],"segment":"__PAGE__"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/eef3252e494c38ff.css","precedence":"next"}]]}],"segment":"discordbots"},"styles":[]}],"segment":"projects"},"styles":[]}]}]]}]}],null]
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Jimmy Lam"}],["$","meta","2",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","3",{"name":"next-size-adjust"}]]
